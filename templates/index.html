<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="" />
  <meta name="author" content="" />
  <title>화성시 스마트 그린도시 생태체험</title>
  <!-- Favicon-->
  <link rel="icon" type="image/x-icon" href="../static/assets/favicon.ico" />
  <!-- Font Awesome icons (free version)-->
  <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
  <!-- Google fonts-->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet"
    type="text/css" />
  <!-- Core theme CSS (includes Bootstrap)-->
  <link href="../static/css/styles.css" rel="stylesheet" />
  <link rel="stylesheet" href="../static/css/style.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.0.2/TweenMax.min.js"></script>
  <!-- Chat -->
  <link rel="stylesheet" href="/static/css/chat_style.css">
  <!-- jQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body id="page-top">
  <!-- Masthead-->
  <header class="masthead text-white text-center">
    <div class="container d-flex align-items-center flex-column">
      <nav class="bg-image-full"></nav>
      <div class="layers bg-image-full"></div>
      <div class="forest bg-image-full"></div>

      <section class="box">
        <div class="my-5 centered_box">
          <div class="menu column">
            <a href="https://greencityhs.or.kr/" class="back col-lg-6">스마트 그린도시<br>
              홈페이지</a> <!-- 시민포탈 -->
            <i class="fa-solid fa-circle-chevron-left"></i>
            <button class="admin_button" onclick="window.location.href='https://hsgreenedu.or.kr:442/'">게시판</button>
            <!-- <button class="admin_button" onclick="window.location.href='http://localhost:3000'">게시판</button> -->
          </div>
          <div class="menu row justify-content-center text_area">
            <p class="title col-lg-6 lead masthead-subheading">화성시 <br />스마트 그린도시</p>
            <p class="grad_text mb-0 masthead-heading">
              생태 체험<br>서비스<br>
            </p>
          </div>
          <span class="down_arrow"><i class="fa-solid fa-circle-chevron-down item"></i></span>
        </div>
        <span data-diagram="bird" class="col-md-6 model_bird">
        </span>
      </section>
      <div class="bg-image bg-image-full"></div>
    </div>
  </header>
  <section class="main_background justify-content-center">
    <div class="container intro col-lg-12">
      <div class="divider">
        <div class="divider_L"></div>
        <div class="divider_R"></div>
      </div>
      <p class="intro_p container">
        <strong>화성습지공원</strong>은 <br />
        도시의 산업화로 오염된 시화호의 <br />수질 개선과 자연 생태계의 회복을 위해<br />
        화성시에서 2002년에 만든 <br />인공 습지예요.
      </p>
    </div>
    <div class="section">
      <div class="sec container col-lg-12">
        <p class="sec_p left">
          화성시와 주민들의 노력으로 수생식물들이 먼저 수질 오염을 정화 시키는 갈대, 부들, 수련 등을 통해 수질 정화된
          습지에 친환경 지표 생물들의 숫자가 늘어나면서 멸종 위기의 수달, 삵 등의 포유류까지 이곳 화성습지공원에 정착하게
          되었답니다.
        </p>
        <div class="shapes left">
          <div class="underline"></div>
          <div class="circles">
            <div class="dashed_circle left"></div>
            <div class="solid_circle left"></div>
            <div class="ani_sec frog">
              <img class="frog_img" src="../static/images/frog.png" />
            </div>
            <span data-diagram="frog" class="col-md-6 ani_sec frog">
            </span>
          </div>
        </div>
      </div>
      <div class="sec container col-lg-12">
        <p class="sec_p right">
          떠나간 동식물이 다시 돌아오기까지 많은 시간이 흘렀고 많은 사람들의 노력으로 다행히 지금은 회복이 되어
          균형 잡힌 생태계의 모습을 갖추게 되었답니다.
        </p>
        <div class="shapes right">
          <div class="circles">
            <div class="dashed_circle right"></div>
            <div class="solid_circle right"></div>
            <div class="ani_sec otter">
              <img class="otter_img" src="../static/images/otter.png" />
            </div>
            <span data-diagram="otter" class="col-md-6 ani_sec otter">
            </span>
          </div>
          <div class="underline"></div>
        </div>
      </div>
      <div class="sec container col-lg-12">
        <p class="sec_p left">
          A, B, C 길을 모두 걷고 나면 화성습지공원 대표 동식물 15종을 만나게 되고 비봉습지를 알리는 명예홍보위원으로의
          자격도 부여받게 된답니다.
        </p>
        <div class="shapes left">
          <div class="underline"></div>
          <div class="circles">
            <div class="dashed_circle left"></div>
            <div class="solid_circle left"></div>
            <div class="ani_sec catfish">
              <img class="catfish_img" src="../static/images/catfish.png" />
            </div>
            <span data-diagram="dragon_fly" class="col-md-6 ani_sec dragon_fly">
          </div>
        </div>
      </div>
    </div>

    <div id="enter bg-dark">
      <div class="ground">

        <!-- Chat -->
        <div id="entry-box">
          <input type="text" id="nickname-entry" placeholder="닉네임을 입력하세요.">
          <button id="startChat">채팅 시작</button>
        </div>
        <div id="chat-box" style="display: none;">
          <div id="users-online">Users Online: 0</div>
          <div id="messages"></div>
        </div>
        <div class="chat-input">
          <input type="text" id="message" placeholder="메시지를 입력하세요.">
          <button id="sendBtn">보내기</button>
        </div>
        <div class="button_area">
          <button id="goToWebGL" class="btn">생태체험 컨텐츠로<br>이동</button>
          <span class="topbtn" onclick="window.scrollTo({top:0,behavior:'smooth'});">
            <i class="fa-solid fa-circle-chevron-up item button-rainbow"></i>
          </span>
        </div>
        <div class="plants_area">
          <img class="forest1" src="../static/images/thickForest/Layer6.png" alt="" />
          <img class="forest2" src="../static/images/thickForest/Layer7.png" alt="" />
          <img class="forest4" src="../static/images/thickForest/Layer8.png" alt="" />
          <img class="forest5" src="../static/images/thickForest/Layer10.png" alt="" />
          <img class="forest6" src="../static/images/thickForest/Layer8.png" alt="" />
        </div>
      </div>
    </div>
    <footer class="py-5 bg-image-full ground_area">
      <div class="container"></div>
    </footer>
  </section>
  <!-- Bootstrap core JS-->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Core theme JS-->
  <script src="../static/js/scripts.js"></script>
  <script src="../static/js/script.js"></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/110/three.min.js"></script> -->
  <script type="module" src="../static/js/index.js"></script>

  <!-- Chat -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
  <script src="/static/js/chat.js"></script>
  <script src="{{ url_for('static', filename='js/index.js') }}"></script>

  <script>
    $(document).ready(function () {

      // URL에서 user_id 파라미터를 가져오기
      const queryParams = new URLSearchParams(window.location.search);
      const encryptedUserId = queryParams.get('user_id');

      // // 암호화된 user_id를 저장할 변수
      // let encryptedUserId;

      // // 암호화된 user_id 가져오기
      // $.ajax({
      //   url: '/get_encrypted_user_id',
      //   method: 'GET',
      //   success: function (data) {
      //     // console.log('Encrypted User ID:', data.encrypted_user_id);
      //     encryptedUserId = data.encrypted_user_id; // 암호화된 user_id 저장
      //   }
      // });

      // WebGL 페이지로 넘어가는 버튼에 클릭 이벤트 핸들러 추가
      $('#goToWebGL').on('click', function () {
        // var encryptedUserId = new URLSearchParams(window.location.search).get('user_id');

        if (encryptedUserId) {
          // API 요청을 통해 userId의 유효성 검사
          $.ajax({
            url: 'https://hsgreenedu.or.kr:442/api/validateUserId',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({ userId: encryptedUserId }),
            success: function (response) {
              // console.log(response);
              // 성공적으로 유효한 userId인 경우 WebGL 페이지로 이동
              window.location.href = 'https://hsgreenedu.or.kr:442/webgl?user_id=' + encodeURIComponent(encryptedUserId);
              // window.location.href = 'https://172.16.10.120:8081?user_id=' + encryptedUserId;
              // window.location.href = 'http://localhost:5555?user_id=' + encryptedUserId;
            },
            error: function (jqXHR, textStatus, errorThrown) {
              // 여기서 jqXHR 객체를 사용하여 서버의 응답을 확인합니다.
              console.log("Error: ", jqXHR.responseText); // 서버의 응답 메시지를 로그로 출력
              alert('오류가 발생했습니다: ' + textStatus); // 사용자에게 오류 메시지를 표시
              window.location.href = 'https://greencityhs.or.kr';
            }
          });
        } else {
          // userId가 없는 경우
          alert('User ID 로딩 중, 잠시 후 다시 시도해주세요.');
        }
      });

      // user_id가 없거나 공백이거나, 서버에서 유효하지 않다는 응답을 받으면 메인 페이지로 리다이렉션
      // if (!userId || userId.trim() === '') {
      //   alert('유효하지 않은 접근입니다.');
      //   window.location.href = 'https://greencityhs.or.kr/'; // 시민포탈로 리턴
      // } else {
      //   fetch('https://hsgreenedu.or.kr:442/api/validateUserId', {
      //     method: 'POST',
      //     mode : 'cors',
      //     headers: {
      //       'Content-Type': 'application/json'
      //     },
      //     body: JSON.stringify({ userId: userId })
      //   })
      //     .then(response => {
      //       if (!response.ok) {
      //         throw new Error('Network response was not ok');
      //       }
      //       return response.json();
      //     })
      //     .then(data => {
      //       if (data.validUserId) {
      //         // 성공 로직
      //       } else {
      //         alert('존재하지 않는 사용자 아이디입니다.');
      //         window.location.href = 'https://greencityhs.or.kr/';
      //       }
      //     })
      //     .catch(error => {
      //       console.error('There has been a problem with your fetch operation:', error);
      //       // 적절한 오류 처리 로직
      //     });
      // }
    });
  </script>
</body>

</html>